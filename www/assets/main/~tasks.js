function getTasksCall(a,b){if(0==b.rows.length){var c={client:User.client,token:User.lastToken};Page.apiCall("getTasksUncompleted",c,"get","loadTasks")}else{isOffline()?$("#_loader").html(""):$("#_loader").html("syncing ...");for(var d="",e="",f=[],g=0,h=0;h<b.rows.length;h++)void 0==f[b.rows.item(h).date_start]&&(f[b.rows.item(h).date_start]=new Array),f[b.rows.item(h).date_start][g]={title:b.rows.item(h).title,id:b.rows.item(h).id,overdue:b.rows.item(h).overdue},g++;for(var h in f)if("function"!=typeof f[h]){date=new Date(h),d+='<li data-role="list-divider">'+Page.formatTaskDate(date)+"</li>";for(var g in f[h])"function"!=typeof f[h][g]&&(e="true"==f[h][g].overdue?'<span class="ui-li-count overdue">OVERDUE</span>':"",d+='<li><a href="task_view.html?id='+f[h][g].id+'" data-transition="slide"><i class="fa fa-square-o"></i> '+f[h][g].title+"</a>"+e+"</li>")}$("#tasks").find("#taskList").html(d).listview("refresh")}}function getTasks(a){a.executeSql('select * from tasks WHERE "completed" = 0',[],getTasksCall,db.dbErrorHandle)}function tasksInit(){if(User.isLogged()){var a=db.getDbInstance();a.transaction(getTasks,db.dbErrorHandle)}else alert("aici ma duc spre login"),Page.redirect("login.html")}function loadTasks(a){if(a.success&&(User.setToken(a.token),a.tasks)){var b="",c="",d='INSERT INTO "tasks"("id","title","overdue", "dueDate", "completed", "check", "date_start")',e=!1;for(var f in a.tasks){c=new Date(f),b+='<li data-role="list-divider">'+Page.formatTaskDate(c)+"</li>";var g="";for(var h in a.tasks[f])e?d+=" UNION":e=!0,d+=' SELECT "'+a.tasks[f][h].id+'" as "id", "'+a.tasks[f][h].taskName+'" as "title", "'+a.tasks[f][h].overdue+'" as "overdue", \''+JSON.stringify(a.tasks[f][h].dueDate)+'\' as "dueDate", "0" as "completed", "'+md5(JSON.stringify(a.tasks[f][h]))+'" as "check", "'+f+'" as date_start',g=a.tasks[f][h].overdue?'<span class="ui-li-count overdue">OVERDUE</span>':"",b+='<li><a href="task_view.html?id='+a.tasks[f][h].id+'" data-transition="slide"><i class="fa fa-square-o"></i> '+a.tasks[f][h].taskName+"</a>"+g+"</li>"}db.clean(),db.execute(d),$("#tasks").find("#taskList").html(b).listview("refresh")}}