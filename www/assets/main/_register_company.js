function close_help(){closed_help=!0,$(".swipe_help").css("display","none")}function object_merge(a,b){var c={};for(var d in a)a.hasOwnProperty(d)&&(c[d]=a[d]);for(var d in b)b.hasOwnProperty(d)&&(c[d]=b[d]);return c}function register_companyInit(){$("#no_results").text("Loading ..."),mySwiper=new Swiper(".swiper-container",{calculateHeight:!0,releaseFormElements:!0,preventLinks:!1,simulateTouch:!1,onInit:function(){setSwiperMinHeight()},onSlideChangeStart:function(a){},onSlideNext:function(a){_t="save"},onSlidePrev:function(a){_t="edit"},onSlideChangeEnd:function(a){if(mySwiper.resizeFix(),parseInt(a.activeIndex)==parseInt(a.previousIndex)&&a.previousIndex--,18==t_counter&&setTimeout(function(){window.location.href="index.html"},3e3),$("html, body").animate({scrollTop:0},500),"save"==_t){$(".overflow-wrapper").removeClass("overflow-wrapper-hide");var b=Form.validate(a.getSlide(a.previousIndex));if(b){var c=Form.getValues(a.getSlide(a.previousIndex));company_data&&(c=object_merge(company_data,c)),currentStep=a.activeIndex+1;var d={step:t_counter,parameters:JSON.stringify(c)};t_counter=parseInt(t_counter)+1,loadedSteps.push(a.activeIndex),Page.apiCall("newCompanyRegistration",d,"post","newCompanyRegistration"),cleanup=a.previousIndex}else a.swipePrev(),$(".overflow-wrapper").addClass("overflow-wrapper-hide")}}}),data={step:1},Page.apiCall("newCompanyRegistration",data,"post","newCompanyRegistration")}function newCompanyRegistration(a){if(console.log("---------------------------------------------------------------------------"),console.log("trigger step received"),$(".overflow-wrapper").addClass("overflow-wrapper-hide"),a.success)if(a.registration_steps.error){t_counter=parseInt(t_counter)-1,mySwiper.swipePrev();var b=a.registration_steps[0],c=[];for(var d in b)b.hasOwnProperty(d)&&"audit_participants"!=d&&c.push(b[d]);var e=$(mySwiper.activeSlide()),f=$.t("registering.invalid_email_exist");if(-1!=c.indexOf("company_email")){var g=e.find('input[name="email"]');$('<label id="'+g.attr("id")+'_validate" class="validate_error">'+f+"</label>").insertAfter(g.parent())}if(-1!=c.indexOf("haccp_resonsible")){var g=e.find('input[name="responsible_for_haccp"]');$('<label id="'+g.attr("id")+'_validate" class="validate_error">'+f+"</label>").insertAfter(g.parent())}if(void 0!=b.audit_participants){var h=b.audit_participants,i=e.find('input[name="internal_audit_participant[]"]');for(var d in h)h.hasOwnProperty(d)&&i.each(function(){return $(this).val()==h[d]?($('<label id="'+$(this).attr("id")+'_validate" class="validate_error">'+f+"</label>").insertAfter($(this).parent()),!1):void 0})}}else{if(cleanup!==!1&&(mySwiper.removeSlide(cleanup),mySwiper.reInit(),mySwiper.resizeFix()),18==t_counter){var j='<div class="no_results" style="color:#00cde7;font-size:34px;">'+$.t("register.success_message")+"</div>";mySwiper.appendSlide(j,"swiper-slide")}var k,j="";for(var d in a.registration_steps)if(a.registration_steps.hasOwnProperty(d))if("aux"!=d){j='<div style="padding:0 10px;"><form onsubmit="return false;">';for(var l in a.registration_steps[d])if(a.registration_steps[d].hasOwnProperty(l)&&(k=a.registration_steps[d][l],void 0!=k.input))switch(k.input.type){case"text":j+=Form.inputText(l,k.label,k.input.placeholder,k.validation,k.name,k.value);break;case"multiple_text":j+="form12"==d||"form13"==d||"form14"==d||"form15"==d||"form16"==d?Form.multipleInputTextFridge(l,k.label,k.input.placeholder,k.validation,k.input.fields):"form17"==d?Form.multipleInputTextDishWasher(l,k.label,k.input.placeholder,k.validation,k.input.fields):Form.multipleInputText(l,k.label,k.input.placeholder,k.validation);break;case"textarea":j+=Form.textarea(l,k.label,k.input.placeholder,k.validation);break;case"select":j+=Form.selectBox(l,k.label,k.input.data,k.input.placeholder,k.validation);break;case"checkbox_list":j+=Form.checkboxList(l,k.label,k.input.value,k.answers,k.name);break;case"multiple_text_color":j+=Form.multipleTextColor(l,k.label,k.answers);break;case"radio_list":j+="form7"==d||"form9"==d||"form8"==d||"form11"==d?Form.radioList(l,k.label,k.input.value,k.answers,k.name,!0):Form.radioList(l,k.label,k.input.value,k.answers,k.name);break;case"date":j+="form7"==d||"form9"==d||"form8"==d||"form11"==d?Form.inputDate(l,k.label,k.input.placeholder,!0):"form12"==d||"form13"==d||"form14"==d||"form15"==d||"form16"==d||"form17"==d?Form.inputDateV(l,k.label,k.input.placeholder,!1,null,!0):Form.inputDate(l,k.label,k.input.placeholder);break;case"custom":j+=Form.customStep10(l,k.label,k.measurement_question_id,k.frequency,k.haccp);break;case"text_clicker":j+=Form.clickIncrement(l,k.label,k.input.data,k.validation)}j+=Form.inputHidden("update","false"),j+=Form.inputCancel("index.html"),j+="</form></div>",mySwiper.appendSlide(j,"swiper-slide")}else company_data=a.registration_steps[d],company_data.currentCompany=company_data.lastCompanyId;$("#"+$.mobile.activePage.attr("id")).trigger("create"),0==loadedSteps.length&&($(".overflow-wrapper").addClass("overflow-wrapper-hide"),mySwiper.reInit(),mySwiper.resizeFix(),mySwiper.removeSlide(0)),colorpicker&&($(".color-pallet-table").find("td").off("click").on("click",function(){sel_colorpicker.css("background-color",$(this).data("color")),sel_colorpicker.find("input").val($(this).data("color")),$("#popupDialog").popup("close")}),$(".colorpicker-bind").off("click").on("click",function(){sel_colorpicker=$(this),$(".color-pallet-table").find("td").each(function(){$(this).data("color")==sel_colorpicker.find("input").val()?$(this).find("img").css("visibility","visible"):$(this).find("img").css("visibility","hidden")}),$("#popupDialog").popup("open")}),colorpicker=!1)}}function function_asd(){var a=Form.getValues(mySwiper.getSlide(0));return console.log(a),!1}var mySwiper,loadedSteps=[],currentStep=0,colorpicker=!1,sel_colorpicker=!1,company_data=!1,closed_help=!1,_t=!1,cleanup=!1,t_counter=1,lid="";