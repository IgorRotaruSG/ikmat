!function(a,b){a.widget("mobile.simpledialog",a.mobile.widget,{options:{version:"1.0.1-2012021300",pickPageTheme:"b",pickPageInputTheme:"e",pickPageButtonTheme:"a",fullScreen:!1,fullScreenAlways:!1,disabled:!1,zindex:"500",width:"280px",prompt:"Are you sure?",mode:"bool",allowReopen:!0,useModal:!0,forceInput:!0,isOpen:!1,blankMode:!1,fullHTML:null,subTitle:!1,inputPassword:!1,cleanOnClose:!1,animate:!0,transition:"pop",clickEvent:"click",left:b,top:b,useDialogForceTrue:!1,useDialogForceFalse:!1,useDialog:!1,isInit:!1,sawOnce:!1,enterToTrigger:0,escToTrigger:1,butObj:[],debug:!1,selects:!1,selectparent:[],onCreated:null,onOpened:null,onClosed:null,onShown:null},_eventHandler:function(b,c){var d=a(this).data("simpledialog"),e=d.options;if(!b.isPropagationStopped())switch(c.method){case"close":d.close(c.fromCloseButton);break;case"open":d.open();break;case"refresh":d.refresh();break;case"button":e.butObj[c.index].trigger(e.clickEvent)}},_orientChange:function(b){var c=a(b.currentTarget).data("simpledialog"),d=c.options,e=a.mobile.activePage.width(),f=a(window).scrollTop(),g=a(window).height(),h=c.pickerContent.outerHeight(),i=c.pickerContent.innerWidth(),j=parseFloat(d.top)+1e4?parseFloat(d.top):f+g/2-h/2,k=parseFloat(d.left)+1e4?parseFloat(d.left):e/2-i/2;return h+j>a(document).height()&&(j=a(document).height()-(h+2)),45>j&&(j=45),b.stopPropagation(),c.pickerContent.is(":visible")&&d.useDialog!==!0?void c.pickerContent.css({top:j,left:k}):!1},open:function(){if(this.pickPage.is(":visible"))return!1;var b=this,c=this.options,d=a.mobile.activePage.width(),e=a(window).scrollTop(),f=a(window).height(),g=b.pickerContent.outerHeight(),h=b.pickerContent.innerWidth(),i=a(window).scrollTop(),j=a(window).scrollLeft(),k=parseFloat(c.top)+1e4?parseFloat(c.top):e+f/2-g/2,l=parseFloat(c.left)+1e4?parseFloat(c.left):d/2-h/2;g+k>a(document).height()&&(k=a(document).height()-(g+2)),45>k&&(k=45),c.prompt!==!1&&(b.pickerHeader.html(c.prompt),b.pickPage.find(".ui-header").find(".ui-title").text(c.prompt)),b.pickerContent.find(".ui-btn-active").removeClass("ui-btn-active"),"blank"===c.mode&&b.pickerContent.delegate('[rel="close"]',c.clickEvent,function(){b.close()}),c.disabled||(d>400&&!c.useDialogForceTrue||c.useDialogForceFalse||c.fullScreen?(c.useDialog=!1,c.fullScreen===!1&&(c.useModal===!0?c.animate===!0?b.screen.fadeIn("slow"):b.screen.show():b.screen.removeClass("ui-simpledialog-hidden")),"blank"===c.mode&&(c.selects=b.pickPage.find(".ui-selectmenu"),c.selects.each(function(){c.selectparent.push(a(this).closest(".ui-dialog")),a(this).appendTo(b.thisPage)})),b.pickerContent.addClass("ui-overlay-shadow").css("zIndex",b.options.zindex),b.pickerHeader.show(),c.fullScreenAlways||c.fullScreen&&400>d?b.pickerContent.css({border:"0px !important",position:"absolute",top:i,left:j,height:f,width:d,maxWidth:d}).addClass("ui-overlay-shadow in").removeClass("ui-simpledialog-hidden"):b.pickerContent.css({position:"absolute",top:k,left:l}).addClass("ui-overlay-shadow in").removeClass("ui-simpledialog-hidden")):(b.thisPage.unbind("pagehide.remove"),c.useDialog=!0,b.pickPageContent.append(b.pickerContent),b.pickerHeader.hide(),b.pickerContent.removeClass("ui-overlay-shadow ui-simpledialog-hidden").css({top:"auto",left:"auto",marginLeft:"auto",marginRight:"auto"}).css("zIndex",b.options.zindex),a.mobile.changePage(b.pickPage,{transition:c.animate===!0?c.transition:"none"})),this.options.isOpen=!0)},close:function(b){var c=this;b="undefined"==typeof b?!1:b,c.options.useDialog?(b===!1&&a(c.pickPage).dialog("close"),"undefined"==typeof c.thisPage.jqmData("page")||c.thisPage.jqmData("page").options.domCache||c.thisPage.bind("pagehide.remove",function(){a(c).remove()}),c.pickerContent.addClass("ui-simpledialog-hidden"),c.thisPage.append(c.pickerContent)):(c.options.useModal?c.options.animate===!0?c.screen.fadeOut("slow"):c.screen.hide():c.screen.addClass("ui-simpledialog-hidden"),c.pickerContent.addClass("ui-simpledialog-hidden").removeClass("in")),c.caller.removeClass("ui-btn-active"),c.options.isOpen=!1,c.options.cleanOnClose===!0&&c.options.useDialog===!1&&c.clean(),c.options.onClosed&&"function"==typeof c.options.onClosed&&c.options.onClosed(c)},clean:function(){var b=this;b.options.selects!==!1&&(b.options.selects.each(function(){a(this).remove()}),a(b.options.selectparent).each(function(){a(this).remove()})),b.pickerContent.remove(),b.pickPage.remove(),b.screen.remove(),b.caller.removeData("simpledialog")},_create:function(){var b=this,c=a.extend(this.options,this.element.data("options")),d=this.element;if(c.isInit&&c.allowReopen)b.open();else{var e=d.closest(".ui-page"),f=a("<div data-role='dialog' class='ui-simpledialog-dialog' data-theme='"+c.pickPageTheme+"' ><div data-role='header' data-backbtn='false' data-theme='a'><div class='ui-title'>"+c.prompt+"</div></div><div data-role='content'></div></div>"),g=null,h=null;"blank"===c.mode&&(g=a("<div class='ui-simpledialog-container ui-overlay-shadow ui-corner-all ui-simpledialog-hidden "+(c.animate===!0?c.transition:"")+" ui-body-"+c.pickPageTheme+"'></div>"),g.html(c.fullHTML),a("[data-role=content]",f).append(g)),f.appendTo(a.mobile.pageContainer).page().css("minHeight","0px").css("zIndex",c.zindex),c.animate===!0&&f.addClass("pop"),h=f.find(".ui-content"),d.live("simpledialog",b._eventHandler),f.find(".ui-header a").bind(c.clickEvent,function(a){a.preventDefault(),a.stopImmediatePropagation(),b.close(!0)}),c.prompt===!1&&f.find(".ui-header").find(".ui-title").html("&nbsp;"),a.extend(b,{pickPage:f,thisPage:e,pickPageContent:h,screen:screen,caller:d}),b._buildPage(),b.options.isInit=!0,a(document).bind("orientationchange",function(a){d.trigger("orientationchange")}),d.bind("orientationchange",b._orientChange),b.options.onCreated&&"function"==typeof b.options.onCreated&&b.options.onCreated(b)}},_reposition:function(){var b=this,c=this.options,d=a.mobile.activePage.width(),e=a(window).scrollTop(),f=a(window).height(),g=b.pickerContent.outerHeight(),h=b.pickerContent.innerWidth(),i=parseFloat(c.top)+1e4?parseFloat(c.top):e+f/2-g/2,j=parseFloat(c.left)+1e4?parseFloat(c.left):d/2-h/2;g+i>a(document).height()&&(i=a(document).height()-(g+2)),45>i&&(i=45),b.pickerContent.css({position:"absolute",width:h,top:i,left:j})},refresh:function(){return"blank"!==this.options.mode?!1:(this.pickerContent.css("width","auto"),this.pickerContent.html(this.options.fullHTML),this.pickerContent.trigger("create"),this.pickerContent.is(":visible")&&this.options.useDialog===!1&&this._reposition(),void 0)},_init:function(){(!this.options.sawOnce||this.options.allowReopen)&&(this.options.sawOnce=!0,this.open())},_buildPage:function(){var b,c,d,e=this,f=e.options,g=null,h=a("<div>",{"class":"ui-simpledialog-container ui-overlay-shadow ui-corner-all ui-simpledialog-hidden "+(f.animate===!0?f.transition:"")+" ui-body-"+f.pickPageTheme}).css({zIndex:f.zindex,width:f.width}),i=a("<div class='ui-simpledialog-header'><h4></h4></div>").appendTo(h).find("h4");h.bind("webkitAnimationEnd",function(){e.options.onShown&&"function"==typeof e.options.onShown&&e.options.onShown(e)}),"blank"!==f.mode?(f.prompt!==!1?i.html(f.prompt):i.parent().html(),f.subTitle!==!1&&a("<p class='ui-simpledialog-subtitle'>"+f.subTitle+"<p>").appendTo(h),"string"===f.mode&&(b=a("<div class='ui-simpledialog-controls'><input class='ui-simpledialog-input ui-input-text ui-shadow-inset ui-corner-all ui-body-"+f.pickPageInputTheme+"' type='"+(f.inputPassword===!0?"password":"text")+"' name='pickin' /></div>").bind("keyup",function(a){13===a.keyCode&&f.enterToTrigger!==!1&&f.butObj[f.enterToTrigger].trigger(f.clickEvent),27===a.keyCode&&f.escToTrigger!==!1&&f.butObj[f.escToTrigger].trigger(f.clickEvent)}).appendTo(h)),c=a("<div>",{"class":"ui-simpledialog-controls"}).appendTo(h),a.each(f.buttons,function(d,h){h=a.isFunction(h)?{click:h}:h,h=a.extend({text:d,theme:f.pickPageButtonTheme,icon:"check",iconpos:"left",closeOnClick:!0,corners:!0,shadow:!0},h),g=f.butObj.push(a("<a href='#'>"+d+"</a>").appendTo(c).buttonMarkup({theme:h.theme,icon:h.icon,iconpos:h.iconpos,corners:h.corners,shadow:h.shadow}).unbind("vclick").unbind("click").bind(f.clickEvent,function(){"string"===f.mode&&e.caller.attr("data-string",b.find("input").val());var a=h.click.apply(e.element[0],arguments);a!==!1&&h.closeOnClick===!0&&e.close()})),"undefined"!=typeof h.id&&h.id.length>0&&f.butObj[g-1].attr("id",h.id),h.hidden&&f.butObj[g-1].addClass("button-hidden"),h.insertSeparator&&a("<div class='buttons-separator'>").appendTo(c)})):h=e.pickPageContent.contents(),h.appendTo(e.thisPage),d=a("<div>",{"class":"ui-simpledialog-screen ui-simpledialog-hidden"}).css({"z-index":f.zindex-1}).appendTo(e.thisPage).bind(f.clickEvent,function(a){f.forceInput||e.close(),a.preventDefault()}),f.useModal&&d.addClass("ui-simpledialog-screen-modal"),a.extend(e,{pickerContent:h,pickerHeader:i,screen:d})},disable:function(){this.options.disabled=!0},enable:function(){this.options.disabled=!1}})}(jQuery);