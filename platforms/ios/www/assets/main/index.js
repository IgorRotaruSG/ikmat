function checkUserSession(a){a.executeSql('SELECT * FROM "settings" WHERE "type" IN ("token", "client", "name", "role")',[],getUserHandle,db.dbErrorHandle)}function getUserHandle(a,b){if(4!=b.rows.length)Page.redirect("login.html");else{for(var c,d,e,f,g=0;g<b.rows.length;g++)switch(b.rows.item(g).type){case"token":c=b.rows.item(g).value;break;case"client":d=b.rows.item(g).value;break;case"name":e=b.rows.item(g).value;break;case"role":f=b.rows.item(g).value}localStorage.setItem("user_name",e),localStorage.setItem("role",f),User.login(d,c)}}function indexInit(){var a=db.getDbInstance();a.transaction(checkUserSession,db.dbErrorHandle),executeSyncQuery()}