function getForm2ItemCall(a,b){if(0==b.rows.length)Page.redirect("forms.html");else{var c=$.extend({},b.rows.item(0));last_data_received=JSON.parse(c.form);var d='<form id="form_item_data_save">';d+=HTML.formGenerate(last_data_received,$.t("general.save_button")),d+="</form>",$("#form_item_data2").html(d),$("#"+$.mobile.activePage.attr("id")).trigger("create"),$("#form_item_data_save").on("submit",function(a){a.preventDefault();var b=HTML.getFormValues($(this).parent()),c={client:User.client,token:User.lastToken,results:JSON.stringify(b)},d=!1;for(var e in b)if(b.hasOwnProperty(e)&&void 0!=last_data_received[e].deviation)switch(last_data_received[e].type){case"slider":(b[e]<last_data_received[e].deviation.min||b[e]>last_data_received[e].deviation.max)&&(d=!0);break;case"default":}if(d){var f=confirm($.t("general.deviation_accept_message"));if(f)if(isOffline()){db.lazyQuery({sql:'INSERT INTO "sync_query"("api","data","extra","q_type") VALUES(?,?,?,?)',data:[["formDeviationStart",JSON.stringify(c),document.task_id,"task_saved"]]},0);var g=db.getDbInstance();g.transaction(function(a){a.executeSql('SELECT "value" FROM "settings" WHERE "type"=?',["deviation_form"],function(a,b){if(b.rows.length>0){db.lazyQuery({sql:'UPDATE "tasks" SET "completed"=? WHERE "id"=?',data:[["1",document.task_id]]},0);var c=JSON.parse(b.rows.item(0).value);getDeviationForm(c)}else alert("We have an internal error. Please contact administrator."),window.location.href="index.html"})})}else console.log("aici avem prima chestie"),console.log(c),Page.apiCall("formDeviationStart",c,"get","getDeviation")}else console.log("de aici 1");return!1})}}function getForm2Item(a){a.executeSql('SELECT * FROM "form_item" WHERE "id"=?',[get.id],getForm2ItemCall)}function form_view2Init(){if(User.isLogged()){get=Page.get();var a=db.getDbInstance();a.transaction(getForm2Item,db.dbErrorHandle)}else Page.redirect("login.html")}var last_data_received;