function dump(a){console.log("-----------------------------------------[dump]-----------------------------------------"),console.log(a),console.log("-----------------------------------------[/dump]-----------------------------------------")}function repeat(a,b){if(1>b)return"";for(var c="";b>0;)1&b&&(c+=a),b>>=1,a+=a;return c}function SyncMaster(a){void 0!=a&&(_data=a),this.getAll=function(a){if(void 0==a&&(a=0),a>=_modulesToSync.length)return!1;var b={client:_data.client,token:_data.token,module:_modulesToSync[a]},c=$.ajax({type:"POST",url:settings.apiDomain+"sync",dataType:"jsonp",jsonpCallback:"_syncGetAll",data:b,timeout:settings.requestTimeout});c.error(function(a,b,c){console.warn(a),console.warn(b),console.warn(c),$("#alertPopup .alert-text").html($.t("error.no_internet_for_sync")),$("#alertPopup").on("popupafterclose",function(){$("#alertPopup").unbind("popupafterclose")}),$("#alertPopup").popup("open",{positionTo:"window"})})}}function _syncGetAll(a){$("#login_done").removeClass("hide");var b="";for(var c in a)a.hasOwnProperty(c)&&"token"!=c&&"success"!=c&&"currentTime"!=c&&"form"!=c&&(b='INSERT OR REPLACE INTO "'+c+'"('+(a[c].cols+"").replace(/([a-zA-Z_]+)/g,function(a){return'"'+a+'"'})+") VALUES("+new Array(a[c].cols.split(",").length+1).join("?,").slice(0,-1)+")",db.lazyQuerySync({sql:b,data:a[c].rows},0,"_syncDone",c))}function _syncDone(a){if(_modulesToSync.indexOf(a)>-1&&(_syncCount=parseInt(_syncCount)+1,a=_modulesToSync.indexOf(a),(new SyncMaster).getAll(parseInt(a)+1)),_syncCount==_modulesToSync.length){document._login_client=_data.client,document._login_token=_data.token;var b="user_login_now";fromLandingPage&&(b="landingUserLogin"),db.lazyQuery({sql:'INSERT INTO "settings"("type","value") VALUES(?,?)',data:[["register_edit",_data.first_edit],["haccp",_data.first_haccp],["name",_data.company_name],["role",_data.role],["deviation_form",JSON.stringify(_data.deviation_form)],["contact_name",_data.contact_name]]},0,b);var c="";if(void 0!=_data.company_date_added){var d=_data.company_date_added.date;d=d.split(" "),d=d[0].split("-"),c=d.join("-")}localStorage.setItem("user_name",_data.company_name),localStorage.setItem("contact_name",_data.contact_name),localStorage.setItem("company_name",_data.company_name),localStorage.setItem("role",_data.role),localStorage.setItem("company_join_date",c),$(".overflow-wrapper").removeClass("overflow-wrapper-hide")}return!1}var _syncCount=0,_syncGlobalData=null,_data={},_modulesToSync=["registration","tasks","forms","form_item"],_login_client=null,_login_token=null;